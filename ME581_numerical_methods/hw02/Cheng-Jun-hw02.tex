\documentclass{article}

% Packages required to support encoding
\usepackage{ucs}
\usepackage[utf8x]{inputenc}
\usepackage{graphicx} 
\usepackage{enumitem}
% Packages required by code

% Packages always used
\usepackage{listings}
\usepackage{hyperref}
\usepackage{xspace}
\usepackage[usenames,dvipsnames]{color}
\hypersetup{colorlinks=true,urlcolor=blue}


\usepackage[framed,numbered,autolinebreaks,useliterate] {mcode}

\input{homework.tex}


\begin{document} 



\hypertarget{problem_0_homework_checklist_2}{}
\subsection*{{Problem 4: }}
\label{}

\begin{enumerate}[label=(\alph*)]
\item 
\begin{align*} 
\mA &= \bmat{0 & 1 & 1 & 1\\ 3 & 0 & 3 & -4\\ 1 & 1 & 1 & 2\\ 2 & 3 & 1 & 3}\\
\vb &= \bmat{0 \\ 7 \\ 6 \\ 6 } 
\end{align*} 

\begin{enumerate}[label=(\roman*)] 
\item Partial pivoting 
The output from my code is \begin{align*} \vx = \bmat{4 \\ -3 \\ 1 \\ 2 } \end{align*} 
\item Scaled pivoting 
The output from my code is \begin{align*} \vx = \bmat{4 \\ -3 \\ 1 \\ 2 } \end{align*} 
\end{enumerate} 


\item 
\begin{align*} 
\mA &= \bmat{	0.2115 & 2.296 & 2.715 & 3.215 \\ 
			0.4371 & 3.916 & 1.683 & 2.852 \\ 
			6.099 & 4.324 & 23.20 & 1.578 \\
			4.623 & 0.8926 & 15.32 & 5.305 
			}\\
\vb &= \bmat{8.438 \\ 8.8888 \\ 35.20 \\ 26.14} 
\end{align*} 



\begin{enumerate}[label=(\roman*)] 
\item Partial pivoting 
The output from my code is \begin{align*} \vx = \bmat{0.999081 \\ 0.999913 \\ 1.00021 \\ 1.0001 } \end{align*} 
\item Scaled pivoting 
The output from my code is \begin{align*} \vx = \bmat{0.999081 \\ 0.999913 \\ 1.00021 \\ 1.0001 } \end{align*} 
\end{enumerate} 
\end{enumerate} 

\hypertarget{problem_0_homework_checklist_2}{}
\subsection*{{Problem 5: }}
\label{}
\begin{align*}
\mA &= \bmat{-9 & 11 & -21 & 63 & -252 \\ 
			70 & -69 & 141 & - 421 & 1684 \\
			-575 & 575 & -1149 & 3451 & -13801 \\
			3891 & -3891 & 7782 & -23345 & 93365 \\
			1024 & -1024 & 2048 & -6144 & 24572 }\\
\vb & = \bmat{-356 \\ 2385 \\ -19551 \\ 132274 \\ 34812 }
\end{align*} 
The output of scaled pivoting result is 
\begin{align*}
 \widetilde\vx &= \bmat{1 \\ -0.864667 \\ 0.0848896 \\ 5.27044 \\ 2.64978} \\
 \ve &= \widetilde\vx - \vx  = \bmat{0  \\  0.1353  \\ -0.9151 \\   6.2704    \\1.6498 } \\
\frac{ \|\ve\|}{\|\vx\|} &= 2.929\\
\mA\widetilde\vx-\vb &= \bmat{-0.0009\\   0.0057\\   -0.0470\\    0.3181\\    0.0837}\\
\frac{ \|\vr\|}{\|\vb\|} & = \frac{ \|\mA\widetilde\vx-\vb\|}{\|\vb\|}= \frac{0.3323}{1.3819e+05}=2.4046e-06\\
 \end{align*} 

Therefore, the estimated condition number is $\frac{2.929}{2.4046e-06} = 1.2181e+06$



\hypertarget{problem_0_homework_checklist_2}{}
\subsection*{{Problem 6: }}
\label{}

We can construct 12 equation if there are no external forces, 2 for each node: 
\begin{align*}
\sum F_{1x} &=F_1\cos\alpha + F_3\cos\gamma+F_H &= 0 \\
\sum F_{1y} &=F_v + F_3\cos\gamma + F_1\sin\alpha &= 0 \\
\sum F_{2x} &=F_8\cos\beta + F_9 \cos\alpha-F_2\cos\beta-F_1\cos\alpha &= 0 \\
\sum F_{2y} &=F_5+F_2\sin\beta+F_8\sin\beta-F_1\sin\alpha-F_9\sin\alpha &= 0 \\
\sum F_{3x} &=F_4\cos\beta+F_2\cos\beta-F_3\cos\gamma &= 0 \\
\sum F_{3y} &=F_4\sin\beta-F_2\sin\beta-F_3\sin\gamma &= 0 \\
\sum F_{4x} &=F_6\cos\beta - F_4\cos\beta &= 0 \\
\sum F_{4y} &=-F_4\sin\beta - F_6\sin\beta-F_5 &=0 \\
\sum F_{5x} &=F_7\cos\gamma - F_6\cos\beta -F_8\cos\beta &= 0 \\
\sum F_{5y} &=F_6\sin\beta-F_8\sin\beta-F_7\sin\gamma &= 0 \\
\sum F_{6x} &=-F_7\cos\gamma-F_9\cos\alpha &= 0 \\
\sum F_{6y} &=F_R+F_7\sin\gamma+F_9\sin\alpha &= 0 \\
\end{align*} 
Then the linear equation $\mA\vx=\vb$ becomes: \\
\begin{align*}
\left[\begin{array}{cccccccccccc}
\cos\alpha & 0 & \cos\gamma & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 \\ 
\sin\alpha & 0 & \cos\gamma & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\ 
-\cos\alpha & -\cos\beta & 0 & 0 & 0 & 0 & 0 & \cos\beta & \cos\alpha & 0 & 0 & 0 \\ 
-\sin\alpha & \sin\beta & 0 & 0 & 1 & 0 & 0 & \sin\beta & -\sin\alpha & 0 & 0 & 0 \\ 
0 & \cos\beta & -\cos\gamma & \cos\beta & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & -\sin\beta & -\sin\gamma & \sin\beta & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & -\cos\beta & 0 & \cos\beta & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & -\sin\beta & -1 & -\sin\beta & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & -\cos\beta & \cos\gamma & -\cos\beta & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & \sin\beta & -\sin\gamma & -\sin\beta & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 & -\cos\gamma & 0 & \cos\alpha & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & \sin\gamma & 0 & \sin\alpha & 1 & 0 & 0 \\  
\end{array}\right]
\bmat{F_1 \\ F_2 \\ F_3 \\ F_4 \\ F_5 \\ F_6 \\ F_7 \\ F_8 \\ F_9 \\ F_R \\ F_V \\ F_H }=\vb
\end{align*} 
We know: \\
\begin{align*}
\sin\alpha = 0.447 \\
\cos\alpha = 0.894 \\
\sin\beta = 0.316\\
\cos\beta =  0.949\\
\sin\gamma = 0.707 \\ 
\cos\gamma =0.707 \\ 
\end{align*} 
Then matrix A becomes: \\ 
\begin{align*}
\mA = \left[\begin{array}{cccccccccccc}
0.894 & 0 & 0.707 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 \\ 
0.447 & 0 & 0.707 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\ 
-0.894 & -0.949 & 0 & 0 & 0 & 0 & 0 & 0.949 & 0.894 & 0 & 0 & 0 \\ 
-0.447 & 0.316 & 0 & 0 & 1 & 0 & 0 & 0.316 & -0.316 & 0 & 0 & 0 \\ 
0 & 0.949 & -0.707 & 0.949 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & -0.316 & -0.707 & 0.316 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & -0.949 & 0 & 0.949 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & -0.316 & -1 & -0.316 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & -0.949 & 0.707 & -0.949 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0.316 & -0.707 & -0.316 & 0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & 0 & 0 & 0 & -0.707 & 0 & 0.894 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0.707 & 0 & 0.447 & 1 & 0 & 0 \\  
\end{array}\right]
\end{align*} 

For different configurations: \\
\begin{align*}
\vb_a = \bmat{0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 500 \\  0 \\ 1000 \\ 0 \\ 500 \\ 0 \\ 0}\ \ \ \ \ 
\vb_b = \bmat{0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 500 \\  0 \\ 1000 \\ 0 \\ 1500 \\ 0 \\ 0}\ \ \ \ \ 
\vb_c = \bmat{0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 1500 \\  0 \\ 1000 \\ 0 \\ 500 \\ 0 \\ 0}\ \ \ \ \ 
\vb_d = \bmat{0 \\ 0 \\ 0 \\ 0 \\ -1000 \\ 0 \\  -500 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}\ \ \ \ \ 
\vb_e = \bmat{0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\  500 \\ 0 \\ 1000 \\ 0 \\ 0 \\ 0}\ \ \ \ \ 
\end{align*}
The results are shown: \\
\begin{align*}
F_a= \bmat{	-784.006 \\ -51.402 \\ -991.374 \\ -687.167 \\ -565.711 \\ -687.167 \\
			-991.374 \\ -51.402 \\ -784.006 \\ 1051.35 \\ 1051.35 \\1401.8 \\ }
F_b= \bmat{	-2162.2 \\ -334.561 \\ -611.893 \\ -121.296 \\ -923.341 \\ -121.296 \\ 
			-1672.99 \\ -1125.07 \\ -1323.05 \\ 1774.21 \\ 1399.11 \\ 2365.61 \\}
F_c=\bmat{	-189.822 \\ -610.785 \\ -2362.23 \\ -1149.06 \\ -273.791 \\ -1149.06 \\
			 -1301.13 \\ 179.729 \\ -1028.97 \\ 1379.85 \\ 1754.95 \\ 1839.8 \\}
F_d=\bmat{	727.085 \\ -684.362 \\ 211.065 \\ -212.136 \\ 300.561 \\ -739.007 \\ 
			-495.589 \\ 369.796 \\ -391.926 \\ 525.572 \\ -474.23 \\ -799.237 \\}
F_e=\bmat{	-727.085 \\ 157.491 \\ -211.065 \\ -314.734 \\ 32.4208 \\ 212.136 \\ 
			495.589 \\ -896.666 \\ 391.926 \\ -525.572 \\ 474.23 \\ 799.237 \\ }
\end{align*} 
For the direction of the forces:  negative values indicate forces point outward. Positive direction of $F_V, F_H, F_R $ are as shown in the figure. 
\end{document}
